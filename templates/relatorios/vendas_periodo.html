<!-- templates/relatorios/vendas_periodo.html -->
{% extends 'base.html' %}

{% block content %}
<div class="container">
    <h2>Relatório de Vendas por Período</h2>
    <div class="mb-3">
        <input type="date" id="startDate" class="form-control d-inline w-auto">
        <input type="date" id="endDate" class="form-control d-inline w-auto">
        <button onclick="loadData()" class="btn btn-primary">Filtrar</button>
    </div>
    
    <div id="grafico" class="mb-4"></div>
    
    <table class="table table-striped">
        <thead>
            <tr>
                <th>Data</th>
                <th>Total Vendas</th>
                <th>Valor Total</th>
                <th>Ticket Médio</th>
            </tr>
        </thead>
        <tbody id="tabela-dados">
        </tbody>
    </table>
</div>

{% block scripts %}
<script>
function loadData() {
    const start = document.getElementById('startDate').value;
    const end = document.getElementById('endDate').value;
    
    fetch(`/relatorios/vendas/periodo?start_date=${start}&end_date=${end}`)
        .then(response => response.json())
        .then(data => {
            let html = '';
            data.dados.forEach(item => {
                html += `
                    <tr>
                        <td>${item.data}</td>
                        <td>${item.total_vendas}</td>
                        <td>${formatCurrency(item.valor_total)}</td>
                        <td>${formatCurrency(item.ticket_medio)}</td>
                    </tr>
                `;
            });
            document.getElementById('tabela-dados').innerHTML = html;
        });
}

// Carregar dados iniciais
window.onload = loadData;
</script>
{% endblock %}
{% endblock %}